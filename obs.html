<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>OBS Overlay</title>

<style>
body{
  margin:0;
  background:transparent;
  overflow:hidden;
}

#overlay{
  position:relative;
  width:240px;
  height:240px;
}

#videoContainer{
  position:absolute;
  inset:0;
}

#texto{
  position:absolute;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  opacity:0;
  transition:opacity .5s;
}

#numero{
  font-size:80px;
  color:white;
  text-shadow:0 0 15px white;
}

#label{
  font-size:26px;
  color:white;
}
</style>
</head>

<body>

<div id="overlay">
  <div id="videoContainer"></div>

  <div id="texto">
    <div id="numero"></div>
    <div id="label">Sucessos</div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// ðŸ”’ CORREÃ‡ÃƒO AUTOMÃTICA DE LINK (# â†’ ?perfil=)
if (!window.location.search && window.location.hash) {
  const perfil = window.location.hash.replace("#","");
  window.location.replace(
    window.location.pathname + "?perfil=" + perfil
  );
}

const params = new URLSearchParams(window.location.search);
const perfil = params.get("perfil") || "default";

const firebaseConfig = {
  apiKey: "AIzaSyBzniGkaFn9HzyeS9XhQ9cAETXWIPFcsQw",
  authDomain: "sociedade-mitra-dados.firebaseapp.com",
  databaseURL: "https://sociedade-mitra-dados-default-rtdb.firebaseio.com",
  projectId: "sociedade-mitra-dados",
  storageBucket: "sociedade-mitra-dados.firebasestorage.app",
  messagingSenderId: "155136545326",
  appId: "1:155136545326:web:b9721595277fb7cef685bf"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const container = document.getElementById("videoContainer");
const texto = document.getElementById("texto");
const numero = document.getElementById("numero");

db.ref("resultados/"+perfil).on("value", snap=>{
  if(!snap.exists()) return;

  const {sucessos} = snap.val();

  texto.style.opacity = 0;
  numero.textContent = "";
  container.innerHTML = "";

  const video = document.createElement("video");
  video.src = "dice_animation.webm";
  video.autoplay = true;
  video.muted = true;
  video.playsInline = true;

  container.appendChild(video);

  setTimeout(()=>{
    numero.textContent = sucessos;
    texto.style.opacity = 1;
  },1000);

  setTimeout(()=>{
    texto.style.opacity = 0;
    container.innerHTML = "";
  },7000);
});
</script>

</body>
</html>
