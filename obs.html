<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>OBS Overlay</title>

<style>
body{
  margin:0;
  background:transparent;
  overflow:hidden;
}

#overlay{
  position:relative;
  width:220px;
  height:220px;
}

video{
  width:220px;
  height:220px;
}

#texto{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  text-align:center;
  opacity:0;
}

#numero{
  font-size:80px;
  color:white;
  text-shadow:0 0 15px white;
}

#label{
  font-size:26px;
  margin-top:-10px;
  color:white;
}
</style>
</head>

<body>

<div id="overlay">
  <video id="video" src="dice_animation.webm" muted playsinline></video>

  <div id="texto">
    <div id="numero"></div>
    <div id="label">Sucessos</div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBzniGkaFn9HzyeS9XhQ9cAETXWIPFcsQw",
  authDomain: "sociedade-mitra-dados.firebaseapp.com",
  databaseURL: "https://sociedade-mitra-dados-default-rtdb.firebaseio.com",
  projectId: "sociedade-mitra-dados",
  storageBucket: "sociedade-mitra-dados.firebasestorage.app",
  messagingSenderId: "155136545326",
  appId: "1:155136545326:web:b9721595277fb7cef685bf"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const video = document.getElementById("video");
const numero = document.getElementById("numero");
const texto = document.getElementById("texto");

db.ref("resultado").on("value", snap=>{
  if(!snap.exists()) return;

  const {sucessos} = snap.val();

  // RESET TOTAL
  texto.style.opacity = 0;
  numero.textContent = "";
  video.pause();
  video.currentTime = 0;

  // TOCA VÃDEO
  video.play();

  // MOSTRA TEXTO DEPOIS DE 1s
  setTimeout(()=>{
    numero.textContent = sucessos;
    texto.style.opacity = 1;
  },1000);

  // LIMPA TUDO AO FINAL
  setTimeout(()=>{
    texto.style.opacity = 0;
    video.pause();
    video.currentTime = 0;
  },7000);
});
</script>

</body>
</html>
